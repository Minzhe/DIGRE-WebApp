expr <- read.table("Project/ORMDL3/TCGA/unc.edu_BRCA_IlluminaHiSeq_RNASeqV2.geneExp.tsv", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
source("https://bioconductor.org/biocLite.R")
biocLite("preprocessCore")
library(preprocessCore)
normalize.quantiles(expr, copy = TRUE)
expression <- as.matrix(expr)
expression <- normalize.quantiles(expression, copy = TRUE)
View(expression)
dim(expression)
class(expression[1,1])
"T" in"TC"
"T" %in% "TC"
View(expr)
8000/365
expr.raw <- read.table("Project/ORMDL3/TCGA/unc.edu_BRCA_IlluminaHiSeq_RNASeqV2.geneExp.tsv", sep = "\t", header = TRUE, row.names = 1, stringsAsFactors = FALSE)
library(preprocessCore)
class(expr[1,1])
class(expr.raw[1,1])
class(expr.raw[1,])
class(expr.raw[,1])
expr <- as.matrix(expr.raw)
class(expr[1,])
class(expr[,1])
expr <- normalize.quantiles(expr)
View(expr.raw)
row.names(expr) <- row.names(expr.raw)
View(expr)
colnames(expr) <- colnames(expr.raw)
View(expr)
write.table(expr, file = "Project/ORMDL3/TCGA/unc.edu_BRCA_RNAseq.geneExp.normalized.txt", sep = "\t", row.names = 1)
write.table(expr, file = "Project/ORMDL3/TCGA/unc.edu_BRCA_RNAseq.geneExp.normalized.txt", sep = "\t", row.names = TRUE)
dim(expr)
tumor <- grep("*.*.*.0[1-9][A-Z].*", colnames(expr))
head(tumor, 100)
tail(tumor)
tumor <- grep("*.*.*.0[0-9][A-Z].*", colnames(expr))
normal <- grep("*.*.*.1[0-9][A-Z].*", colnames(expr))
tumor <- grep("*.*.*.0[0-9][A-Z].*.*.*", colnames(expr))
normal <- grep("*.*.*.1[0-9][A-Z].*.*.*", colnames(expr))
tumor <- grep("????.??.????.0[0-9][A-Z].*", colnames(expr))
tumor <- grep("????.??.????.1[0-9][A-Z].*", colnames(expr))
tumor <- grep("????.??.????.0[0-9][A-Z].*", colnames(expr))
normal <- grep("????.??.????.1[0-9][A-Z].*", colnames(expr))
sample <- lapply(strsplit(colnames(expr), ".", fixed = TRUE), "[[", 4)
sample <- sapply(strsplit(colnames(expr), ".", fixed = TRUE), "[[", 4)
table(sample)
tumor <- grep("^1", sample)
tumor <- grep("^0", sample)
normal <- grep("^1", sample)
expr.tumor <- expr[,tumor]
dim(expr.tumor)
expr.normal <- expr[,normal]
dim(expr.normal)
write.table(expr.tumor, file = "Project/ORMDL3/TCGA/unc.edu_BRCA_RNAseq.geneExp.tumor.normalized.txt", sep = "\t", row.names = TRUE)
write.table(expr.normal, file = "Project/ORMDL3/TCGA/unc.edu_BRCA_RNAseq.geneExp.normal.normalized.txt", sep = "\t", row.names = TRUE)
expr.tumor.nearby <- expr.tumor["ERBB2|ORMDL3",]
expr.tumor.nearby <- expr.tumor[row.names(expr.tumor) == "ERBB2|ORMDL3",]
expr.tumor.nearby <- expr.tumor[row.names(expr.tumor) == "ERBB2"|"ORMDL3",]
expr.tumor.nearby <- expr.tumor[row.names(expr.tumor) == "ERBB2" | row.names(expr.tumor) == "ORMDL3",]
expr.tumor.nearby <- expr.tumor[grep("ERBB2|ORMDL3", row.names(expr.tumor)),]
View(expr.tumor.nearby)
expr.tumor.nearby <- expr.tumor[grep("ERBB2|ORMDL3", row.names(expr.tumor)),][-1,]
View(expr.tumor)
expr.normal.nearby <- expr.normal[grep("ERBB2|ORMDL3", row.names(expr.normal)),][-1]
expr.normal.nearby <- expr.normal[grep("ERBB2|ORMDL3", row.names(expr.normal)),]
View(expr.tumor.nearby)
View(expr.normal.nearby)
expr.normal.nearby <- expr.normal[grep("ERBB2|ORMDL3", row.names(expr.normal)),][-1,]
View(expr.tumor.nearby)
plot(expr.tumor.nearby[2,], expr.tumor.nearby[1,], pch = 19, col = "red")
plot(expr.normal.nearby.nearby[2,], expr.normal.nearby.nearby[1,], pch = 19, col = "red")
plot(expr.normal.nearby[2,], expr.normal.nearby[1,], pch = 19, col = "red")
plot(expr.normal.nearby.nearby[2,], expr.normal.nearby.nearby[1,], pch = 19, col = "red", log = "xy")
plot(expr.tumor.nearby[2,], expr.tumor.nearby[1,], pch = 19, col = "red", log = "xy")
1e5
5*e5
5*e^5
5e5
e*e
log(6864)
log(0)
as.integer(1e5)
plot(1:1104, expr.normal.nearby[1,], log = "y")
plot(1:1104, expr.tumor.nearby[1,], log = "y")
exp.t <- log10(expr.tumor.nearby)
exp.n <- log10(expr.normal.nearby)
View(exp.t)
plot(exp.t[2,], exp[1,], pch = 19, col = "red")
plot(exp.t[2,], exp.t[1,], pch = 19, col = "red")
points(exp.n[2,], exp.n[1,], pch = 19, col = "blue")
expr.log <- log10(expr.raw+1)
View(expr.log)
expr.log.nearby <- expr.log[grep("ERBB2|ORMDL3", row.names(expr.log)),][-1,]
View(expr.log.nearby)
plot(expr.log[2,], expr[1,], pch = 19, col = "red")
plot(expr.log[2,], expr.log[1,], pch = 19, col = "red")
plot(expr.log.nearby[2,], expr.log.nearby[1,])
plot(expr.log.nearby[2,], expr.log.nearby[1,])
View(expr.log.nearby)
plot(expr.log.nearby[2,], expr.log.nearby[1,])
plot(expr.log.nearby[2,], expr.log.nearby[1,])
View(expr.log.nearby)
expr.log.nearby[2,]
summary(expr.log.nearby[2,])
class(expr.log.nearby[1,])
expr.log.nearby <- as.matrix(expr.log.nearby)
plot(expr.log.nearby[2,], expr.log.nearby[1,])
log(50000)
log(500000)
expr <- as.matrix(log(expr + 1))
View(expr)
expr.tumor <- expr[,tumor]
expr.normal <- expr[,normal]
write.table(expr.tumor, file = "Project/ORMDL3/TCGA/unc.edu_BRCA_RNAseq.geneExp.tumor.txt", sep = "\t", row.names = TRUE)
expr <- round(as.matrix(log(expr + 1)), digits = 6)
View(expr)
expr.tumor <- expr[,tumor]
View(expr.tumor)
write.table(expr.tumor, file = "Project/ORMDL3/TCGA/unc.edu_BRCA_RNAseq.geneExp.tumor.txt", sep = "\t", row.names = TRUE)
expr.normal <- expr[,normal]
write.table(expr.normal, file = "Project/ORMDL3/TCGA/unc.edu_BRCA_RNAseq.geneExp.normal.txt", sep = "\t", row.names = TRUE)
dd <- data.frame(b = factor(c("Hi", "Med", "Hi", "Low"),
levels = c("Low", "Med", "Hi"), ordered = TRUE),
x = c("A", "D", "A", "C"), y = c(8, 3, 9, 9),
z = c(1, 1, 1, 2))
dd
dd[with(dd, order(-z, b)), ]
2^3
2^(1:2)
x1 <- cbind(1, 1:10)
x1
norm(x1)
normalize(x1)
scale(x1)
sample(1:10, 10)
x <- sample(1:10, 10)
x
x[order(x)]
sort(x)
lines(x, x*x)
plot.new()
lines(x, x*x)
plot(1:10, 1:10)
lines(x, x*x)
plot(1:10, 1:10)
lines(x, x*x/10)
plot(1:10, 1:10)
plot(1:10, 0.5*x+1)
plot(1:10, 1:10)
plot(x, 0.5*x+1)
plot(1:10, 1:10)
lines(x, 0.5*x+1)
dhyper(0, 52, 59, 15)
dhyper(0, 59, 52, 15)
plot.new()
dhyper(1:15, 59, 52, 15)
plot(1:15, dhyper(1:15, 59, 52, 15))
phyper(1:15, 59, 52, 15)
plot(1:15, phyper(1:15, 59, 52, 15))
phyper(0, 59, 52, 15)
1030
1030+4127
1030+4127+2654+11593
2654+11593
4127+2654
phyper(4127, 5157, 14247, 6781)
phyper(4127, 5157, 14247, 6781, lower.tail = FALSE)
dhyper(4127, 5157, 14247, 6781)
plot(1:6781, dhyper(1:6721, 5157, 14247, 6781))
plot(1:6781, dhyper(1:6781, 5157, 14247, 6781))
1663+2137+3857+9688
phyper(4127, 1030+4127, 2654+11593, 4127+2654)
phyper(4127, 1030+4127, 2654+11593, 4127+2654, lower.tail = FALSE, log.p = TRUE)
phyper(4806, 1496+4806, 3559+15374, 4806+3559, lower.tail = FALSE, log.p = TRUE)
phyper(4127, 1030+4127, 2654+11593, 4127+2654, lower.tail = FALSE, log.p = TRUE)
phyper(2137, 1663+2137, 3857+9688, 2137+3857, lower.tail = FALSE, log.p = TRUE)
-490.7302/log(10)
-3134.867/log(10)
10e-213.1214
10^-213.1214
1663+2137
x <- 1:100
y <- 1:50
diff(x, y)
diff(x, y, lag = 1)
diff(x)
diff(1:10, 2)
phyper(1496, 1496+4806, 3559+15374, 4806+3559)
phyper(1496, 1496+4806, 3559+15374, 4806+3559, lower.tail = FALSE)
phyper(4806, 1496+4806, 3559+15374, 4806+3559, lower.tail = FALSE)
phyper(4806, 1496+4806, 3559+15374, 4806+3559, lower.tail = FALSE, log.p = TRUE)
phyper(4806, 3559+4806, 1496+15374, 4806+1496, lower.tail = FALSE, log.p = TRUE)
10^-1490
10^-0.8685
dugPair <- read.table("C:/Users/s418336/Documents/Project/Drug_combination/report/nat.biotech.pair.txt", sep = "\t", header = TRUE, row.names = 1, stringsAsFactors = FALSE)
View(dugPair)
install.packages("d3heatmap")
library(d3heatmap)
drugPair <- dugPair
rm(dugPair)
d3heatmap(drugPair)
d3heatmap(drugPair, colors = "blues")
d3heatmap(drugPair, colors = "Blues")
d3heatmap(drugPair, colors = "Reds")
d3heatmap(drugPair, colors = c("red", "yellow", "blue"))
d3heatmap(drugPair, colors = c("yellow", "blue", "red"))
d3heatmap(drugPair, colors = c("yellow", "blue4", "red"))
d3heatmap(drugPair, colors = c("yellow", "blue3", "red"))
d3heatmap(drugPair, colors = c("yellow", "dodgerblue", "red"))
d3heatmap(drugPair, colors = c("yellow", "dodgerblue4", "red"))
d3heatmap(drugPair, colors = c("yellow", "dodgerblue3", "red"))
d3heatmap(drugPair, colors = c("yellow", "royalblue", "red"))
d3heatmap(drugPair, colors = c("yellow", "royalblue1", "red"))
d3heatmap(drugPair, colors = c("yellow", "royalblue3", "red"))
d3heatmap(drugPair, colors = c("yellow", "navy", "red"))
d3heatmap(drugPair, colors = c("yellow", "dodgerblue3", "red"))
dnorm(10)
dnorm(1:10)
plot(1:10, dnorm(1:10))
rnorm(10)
hist(rnorm(10))
hist(rnorm(20))
hist(rnorm(20))
hist(rnorm(30))
hist(rnorm(50))
hist(rnorm(100))
hist(rnorm(300))
hist(rnorm(500))
hist(rnorm(1000))
10^0.76/10^0.13
10^0.13
10^0.14
10^2.280691
10^-2.797124
10^2.264972
10^0.5
10-0.23
10^-0.23
10^-1.35
10^2.39971
10^0.09
10^1.2
10^1.161636
10^0.45
10^3.15
10^0.335847
10^4.740444
10^0.92
setwd("Project/Drug_combination/Computaional/data/matlabCode")
tmp <- read.table("NCI-DREAMSubchallenge2_GoldStandard.txt",sep="\t",header=T)
View(tmp)
drug <- sort(unique(as.vector(apply(tmp[,1:2],2,as.character))))
length(drug) # 14
names <- c("Aclacinomycin A","Blebbistatin","Camptothecin",
"Cycloheximide","DMSO","Doxorubicin hydrochloride",
"Etoposide","Geldanamycin","H-7, Dihydrochloride",
"Media","Methotrexate","Mitomycin C",
"Monastrol","Rapamycin","Trichostatin A",
"Vincristine");
"Vincristine"); length(names) # 16
length(names)
names
names2 <- names[c(-5,-10)]
length(names2)
print(cbind(drug,names2))
setwd("..")
ls()
list.files()
Ly3_expr <- read.csv("ACalifano_DLBCL_Ly3_14Comp_treatment.txt",sep='\t',check.names=F)
View(Ly3_expr)
genename <- strsplit(as.character(Ly3_expr[,2])," ")
genename <- sapply(genename,function(x) x[1])
Ly3_expr[,2] <- genename; Ly3_expr[1:3,2]<-""
View(Ly3_expr)
tmp <- drop(as.matrix(Ly3_expr[1,-c(1:2)]))
dim(Ly3_expr) # 48792 * 284
View(Ly3_expr)
Ly3_expr <- read.csv("ACalifano_DLBCL_Ly3_14Comp_treatment.txt",sep='\t',check.names=F)
genename <- strsplit(as.character(Ly3_expr[,2])," ")
genename <- sapply(genename,function(x) x[1])
Ly3_expr[,2] <- genename; Ly3_expr[1:3,2]<-""
dim(Ly3_expr) # 48792 * 284
tmp <- drop(as.matrix(Ly3_expr[1,-c(1:2)])); names(tmp) <- NULL
drugName <- sort(unique(tmp))
IC20ave24<-Ly3_expr[4:length(Ly3_expr[,1]),1:2]
View(IC20ave24)
for(i in 1:16){
if(i==5){
temp<-Ly3_expr[4:length(Ly3_expr[,1]),Ly3_expr[1,]==names[i]
& Ly3_expr[2,]==24
& Ly3_expr[3,]=="0.01"]
} else if(i==10){
temp<-Ly3_expr[4:length(Ly3_expr[,1]),Ly3_expr[1,]==names[i]
& Ly3_expr[2,]==24
& Ly3_expr[3,]=="N/A"]
} else {
temp<-Ly3_expr[4:length(Ly3_expr[,1]),Ly3_expr[1,]==names[i]
& Ly3_expr[2,]==24
& Ly3_expr[3,]=="1/10 of IC20"]
}
temp<-apply(temp,2,as.numeric)
ave<-apply(temp,1,mean)
IC20ave24<-cbind(IC20ave24,ave)
}
View(IC20ave24)
dim(IC20ave24)
colnames(IC20ave24)[3:length(IC20ave24[1,])]<-names
dim(IC20ave24) # 48789 (#ofProbes) * 16 (#ofDrugs) + 2
View(temp)
temp <- as.matrix(IC20ave24[,3:length(IC20ave24[1,])])
View(IC20ave24)
temp <- normalize.quantiles(temp)
library(preprocessCore)
temp <- normalize.quantiles(temp)
View(temp)
colnames(temp)<-colnames(IC20ave24)[3:length(IC20ave24[1,])]
View(IC20ave24)
View(temp)
dmso.val <- temp[,5]
for(i in 1:length(temp[1,])){
temp[,i]<-temp[,i]-dmso.val # DMSO
}
View(temp)
temp <- temp[,-5] ##delete DSMO
temp <- temp[,-9] ##delete Media
View(IC20ave24)
IC20ave24Diff <- cbind(IC20ave24[,1:2],temp)
dim(IC20ave24Diff) # 48789 * 14 + 2
View(IC20ave24Diff)
tmp.mat  <- IC20ave24Diff[,-c(1,2)]
View(tmp.mat)
dup.gene <- IC20ave24Diff[,2]
length(dup.gene)
length(unique(dup.gene))
IC20.Mean<- aggregate(tmp.mat,list(dup.gene),mean)
IC20.Max <- aggregate(tmp.mat,list(dup.gene),max)
IC20.Min <- aggregate(tmp.mat,list(dup.gene),min)
colnames(IC20.Mean)[1] <- colnames(IC20.Max)[1] <- colnames(IC20.Min)[1] <- "Gene"
View(IC20.Max)
load("~/Project/Drug_combination/Computaional/data/IC20ave24Diff.Rdata")
doseRes1
doseRes2
getwd()
list.files()
setwd("updated.pathwayInfo/pathway/")
xmls <- list.files(path=path,pattern=".xml")
xmls <- list.files(path=".",pattern=".xml")
xmls  <- paste(path,xmls,sep="")
path = "."
xmls  <- paste(path,xmls,sep="")
rm(list=ls())
getwd()
path = getwd()
xmls <- list.files(path=path,pattern=".xml")
xmls  <- paste(path,xmls,sep="")
pathway <- list()
for(i in 1:length(xmls)){
temppath <- xmls[i]
pathway[i] <- parseKGML2Graph(temppath,
#genesOnly=FALSE,
expandGenes=TRUE)
}
library(KEGGgraph)
source("https://bioconductor.org/biocLite.R")
biocLite("KEGGgraph")
library(KEGGgraph)
pathway <- list()
for(i in 1:length(xmls)){
temppath <- xmls[i]
pathway[i] <- parseKGML2Graph(temppath,
#genesOnly=FALSE,
expandGenes=TRUE)
}
path
path = paste(path, "/", sep = "")
path
xmls <- list.files(path=path,pattern=".xml")
xmls  <- paste(path,xmls,sep="")
pathway <- list()
for(i in 1:length(xmls)){
temppath <- xmls[i]
pathway[i] <- parseKGML2Graph(temppath,
#genesOnly=FALSE,
expandGenes=TRUE)
}
length(pathway)
pathway[[1]]
str(pathway[[1]])
print(pathway[[1]])
bigGraph <- mergeKEGGgraphs(pathway)
bigGraphnodes <- nodes(bigGraph)
head(bigGraphnodes)
head(bigGraphnodes, 100)
tail(bigGraphnodes, 100)
length(bigGraphnodes)
remove(list=ls()[!ls()%in%c("bigGraph","bigGraphnodes")]) # keep only bigGraph, bigGraphnodes
getwd()
setwd("../globalpathway/")
getwd()
path = paste(getwd(), "/", sep = "")
path
xmls <- list.files(path=path,pattern=".xml") # 36 global pathways
xmls <- paste(path,xmls,sep="")
pathway <- list()
for(i in 1:length(xmls)){
temppath<-xmls[i]
pathway[i]<-parseKGML2Graph(temppath,
#genesOnly=FALSE,
expandGenes=TRUE)
}
bigGraph2 <- mergeKEGGgraphs(pathway)
bigGraphnodes2 <- nodes(bigGraph2); length(bigGraphnodes2) # 2539
remove(pathway,temppath,xmls,path)
g0 <- bigGraph; n0 <- bigGraphnodes
CGP.mat <- matrix(0,nrow=P,ncol=P)
P <- length(n0)
CGP.mat <- matrix(0,nrow=P,ncol=P)
colnames(CGP.mat) <- rownames(CGP.mat) <- n0
View(CGP.mat)
edges <- getKEGGedgeData(g0)
for(i in 1:length(edges)){
act <- edges[[i]]@subtype[[1]]@name
if(act=="activation"|act=="expression"){
val=1
} else if(act=="inhibition"){
val=-1
} else { val=0 }
if(val!=0){
tmp <- strsplit(names(edges[i]),"~")[[1]]
rid <- which(tmp[1]==n0); cid <- which(tmp[2]==n0)
if(rid==cid) print(tmp)
CGP.mat[rid,cid] <- val
}
}
View(CGP.mat)
load("~/Project/Drug_combination/Computaional/data/updatedPathInfo.Rdata")
View(CGP.mat)
sum(CGP.mat)
dim(CGP.mat)
sum(CGP.mat == 0)
sum(CGP.mat != 0)
View(CGP.mat)
View(GP.mat)
load("~/Project/Drug_combination/Computaional/data/GSE10846.Rdata")
View(aveExpr)
